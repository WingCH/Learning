# flutter_flavorizr


> [flutter_flavorizr](https://pub.dev/packages/flutter_flavorizr) is meant to be run once and only once
>
> https://github.com/AngeloAvv/flutter_flavorizr/issues/4#issuecomment-638034165

這個library的設計是只生成**一次**，並不是每次更新再重新生成，這樣會覆蓋舊的文件。

如果要更新的話，可以嘗試使用 `process`

---

## Goals

|           |         Production         | UAT |
| :-------: | :-----------------: | :-------------: |
| bundle Id | com.mall.app | com.mall.app.uat |
| app name  | Mall | UAT Mall |
|   icon    | <img src="doc/README/image-20220423224250389.png" alt="image-20220423224250389" style="zoom: 25%;" /> | <img src="doc/README/image-20220423224215407.png" alt="image-20220423224215407" style="zoom: 25%;" /> |
| base url | https://www.api.com | https://www.uat.api.com |



---

1. Save app icon to flutter assets folder

   <img src="doc/README/image-20220423230332489.png" alt="image-20220423230332489" style="zoom:50%;" />

2. config `flutter_flavorizr` setting in `pubspec.yaml`

   ```
   flavorizr:
     ide: "idea"
     app:
       android:
         flavorDimensions: "flavor-type"
       ios:
   
     flavors:
       production:
         app:
           name: "Mall"
           icon: "assets/app_icon/production_app_icon.png"
         android:
           applicationId: "com.mall.app"
         ios:
           bundleId: "com.mall.app"
       uat:
         app:
           name: "UAT Mall"
           icon: "assets/app_icon/uat_app_icon.png"
         android:
           applicationId: "com.mall.app.uat"
         ios:
           bundleId: "com.mall.app.uat"
   ```

3. run `flutter pub run flutter_flavorizr`

4. add `$(BUNDLE_NAME)` to Bundle display name in info.plist

   https://github.com/AngeloAvv/flutter_flavorizr/issues/97

   <img src="doc/README/image-20220423230926143.png" alt="image-20220423230926143" style="zoom: 50%;" />

5. [iOS] Delete the following files that are not useful

   1. Delete xcode default configurations, because I don't seem to use<img src="doc/README/image-20220423233215880.png" alt="image-20220423233215880" style="zoom:50%;" />

      <img src="doc/README/image-20220423233710133.png" alt="image-20220423233710133" style="zoom:50%;" />

   2.  Delete the `{env}LaunchScreen` generated by flutter_flavorizr default

      <img src="doc/README/image-20220423233855191.png" alt="image-20220423233855191" style="zoom:50%;" />

3. Delete extra Assets

   <img src="doc/README/image-20220423234309941.png" alt="image-20220423234309941" style="zoom:50%;" />

4. rename `flavors.dart` to `env_config.dart`

   add baseUrl

   ```
   enum Flavor {
     PRODUCTION,
     UAT,
   }
   
   class EnvConfig {
     static Flavor? appFlavor;
   
     static String get name => appFlavor?.name ?? '';
   
     static String get title {
      return appFlavor.toString();
     }
   
     static String get baseUrl {
       switch (appFlavor) {
         case Flavor.PRODUCTION:
           return 'https://www.api.com';
         case Flavor.UAT:
           return 'https://www.uat.api.com';
         default:
           return 'https://www.uat.api.com';
       }
     }
   }
   ```

---

```
flutter run --flavor production -t lib/main_production.dart
flutter run --flavor uat -t lib/main_uat.dart
```

|           |         Production         | UAT |  |
| :-------: | :-----------------: | :-------------: | --------- |
| Android | <img src="doc/README/Screenshot_20220423_235838.png" alt="Screenshot_20220423_235838" style="zoom:25%;" /> | <img src="doc/README/Screenshot_20220423_235829.png" alt="Screenshot_20220423_235829" style="zoom:25%;" /> | <img src="doc/README/Screenshot_20220423_235849.png" alt="Screenshot_20220423_235849" style="zoom:25%;" /> |
| iOS | <img src="doc/README/Simulator%20Screen%20Shot%20-%20iPhone%2013%20Pro%20-%202022-04-24%20at%2000.00.10.png" alt="Simulator Screen Shot - iPhone 13 Pro - 2022-04-24 at 00.00.10" style="zoom:25%;" /> | <img src="doc/README/Simulator%20Screen%20Shot%20-%20iPhone%2013%20Pro%20-%202022-04-24%20at%2000.00.03.png" alt="Simulator Screen Shot - iPhone 13 Pro - 2022-04-24 at 00.00.03" style="zoom:25%;" /> | <img src="doc/README/Simulator%20Screen%20Shot%20-%20iPhone%2013%20Pro%20-%202022-04-24%20at%2000.00.18.png" alt="Simulator Screen Shot - iPhone 13 Pro - 2022-04-24 at 00.00.18" style="zoom:25%;" /> |

